<div>
    <label for="UserName">Username: </label>
    <label for="Email">Email: </label>
    <label for="Password">Password: </label>
</div>
<div>
    <input type="text" name="UserName" id="UserName" />
    <input type="text" name="Email" id="Email" />
    <input type="password" name="Password" id="Password" />
</div>
<button id="submit">Submit</button>
<div id="x" style="color:red;"></div>

<script>
    var submit = document.getElementById("submit");
    submit.addEventListener("click", function () {
        var data = new Object();
        data.UserName = document.getElementById("UserName").value;
        data.Email = document.getElementById("Email").value;
        data.Password = document.getElementById("Password").value;

        postData('/AspNetUsers/Create', data)
          //  .then(data => console.table(data)) // JSON from `response.json()` call
            //.then(function (data) { if (data.Errors) { var x = document.getElementById("x"); x.innerHTML = data.Errors.value; }})
            .then(data =>  handleError(data))
            .catch(error => console.error(error))

    });
    function handleError(data) {
        console.table(data);
        if (data.Errors) {
            document.getElementById("x").innerHTML = data.Errors;
        }
        else
        {
            postData('/AspNetUsers/GetRoles')
                .then(function (result) {
                    console.table(result);
                    var roleList = document.createElement("div");
                    roleList.setAttribute("id", "Roles");

                    roleList.innerHTML = "<select name=\"RoleSelected\"> ";
                    for (var roleName in result.Name) {
                        roleList.innerHTML += " <option value=\" " + roleName + "\">" + roleName + " </option> ";
                    }
                    roleList.innerHTML += " </select>";           
                })
                .catch(error => console.error(error))
        }
    }
   

    function postData(url, data) {
        // Default options are marked with *
        return fetch(url, {
            body: JSON.stringify(data), // must match 'Content-Type' header
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, same-origin, *omit
            headers: {
                'user-agent': 'Mozilla/4.0 MDN Example',
                'content-type': 'application/json'
            },
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, cors, *same-origin
            redirect: 'follow', // manual, *follow, error
            referrer: 'no-referrer', // *client, no-referrer
        })
            .then(response => response.json()) // parses response to JSON
    }
    
</script>